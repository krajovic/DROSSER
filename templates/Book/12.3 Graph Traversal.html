<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0066)http://opendatastructures.org/ods-python/12_3_Graph_Traversal.html -->
<html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>12.3 Graph Traversal</title>
<meta content="12.3 Graph Traversal" name="description"/>
<meta content="ods-python-html" name="keywords"/>
<meta content="document" name="resource-type"/>
<meta content="global" name="distribution"/>
<meta content="LaTeX2HTML v2008" name="Generator"/>
<meta content="text/css" http-equiv="Content-Style-Type"/>
<link href="static/12.3 Graph Traversal_files/ods-book.css" rel="STYLESHEET"/>
<link href="http://opendatastructures.org/ods-python/12_4_Discussion_Exercises.html" rel="next"/>
<link href="http://opendatastructures.org/ods-python/12_2_AdjacencyLists_Graph_a.html" rel="previous"/>
<link href="http://opendatastructures.org/ods-python/12_Graphs.html" rel="up"/>
<link href="http://opendatastructures.org/ods-python/12_4_Discussion_Exercises.html" rel="next"/>
</head>
<body bgcolor="#FFFFFF" text="#000000">
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<!--End of Table of Child-Links-->
<hr/>
<h1><a name="SECTION001530000000000000000">
<span class="arabic">12</span>.<span class="arabic">3</span> Graph Traversal</a>
</h1>
<p>
In this section we present two algorithms for exploring a graph,
starting at one of its vertices, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4671.png" width="9"/></span>, and finding all vertices that
are reachable from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4672.png" width="9"/></span>.  Both of these algorithms are best suited to
graphs represented using an adjacency list representation.  Therefore,
when analyzing these algorithms we will assume that the underlying
representation is an AdjacencyLists.
</p><p>
</p><h2><a name="SECTION001531000000000000000">
<span class="arabic">12</span>.<span class="arabic">3</span>.<span class="arabic">1</span> Breadth-First Search</a>
</h2>
<p>
<a name="55484"></a>The <span class="textit">bread-first-search</span> algorithm starts at a vertex <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4673.png" width="9"/></span> and visits,
first the neighbours of <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4674.png" width="9"/></span>, then the neighbours of the neighbours of <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4675.png" width="9"/></span>,
then the neighbours of the neighbours of the neighbours of <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4676.png" width="9"/></span>, and so on.
</p><p>
This algorithm is a generalization of the breadth-first traversal
algorithm for binary trees (Section <a href="http://opendatastructures.org/ods-python/6_1_BinaryTree_Basic_Binary.html#sec:bintree:traversal">6.1.2</a>), and is
very similar; it uses a queue, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4677.png" width="12"/></span>, that initially contains only <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4678.png" width="9"/></span>.
It then repeatedly extracts an element from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4679.png" width="12"/></span> and adds its neighbours
to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4680.png" width="12"/></span>, provided that these neighbours have never been in <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4681.png" width="12"/></span> before.
The only major difference between the breadth-first-search algorithm
for graphs and the one for trees is that the algorithm for graphs has
to ensure that it does not add the same vertex to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4682.png" width="12"/></span> more than once.
It does this by using an auxiliary boolean array, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{seen}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{seen}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4683.png" width="32"/></span>, that tracks
which vertices have already been discovered.
<br/>
<img align="BOTTOM" alt="\begin{leftbar}
\begin{flushleft}
\hspace*{1em} \ensuremath{\mathrm{bfs}(\ensure...
...] \gets \ensuremath{\ensuremath{\mathit{true}}}}\\
\end{flushleft}\end{leftbar}" border="0" height="239" src="static/12.3 Graph Traversal_files/img4684.png" width="263"/>
<br/>
An example of running <!-- MATH
 $\ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},0)}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},0)}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4685.png" width="58"/></span> on the graph from Figure <a href="http://opendatastructures.org/ods-python/12_Graphs.html#fig:graph">12.1</a>
is shown in Figure <a href="http://opendatastructures.org/ods-python/12_3_Graph_Traversal.html#fig:graph-bfs">12.4</a>.  Different executions are possible,
depending on the ordering of the adjacency lists; Figure <a href="http://opendatastructures.org/ods-python/12_3_Graph_Traversal.html#fig:graph-bfs">12.4</a>
uses the adjacency lists in Figure <a href="http://opendatastructures.org/ods-python/12_2_AdjacencyLists_Graph_a.html#fig:graph-adjlist">12.3</a>.
</p><p>
</p><div align="CENTER"><a name="fig:graph-bfs"></a><a name="57361"></a>
<table>
<caption align="BOTTOM"><strong>Figure 12.4:</strong>
An example of bread-first-search starting at node 0. Nodes are
  labelled with the order in which they are added to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4687.png" width="12"/></span>.  Edges that
  result in nodes being added to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4688.png" width="12"/></span> are drawn in black, other edges
  are drawn in grey.</caption>
<tbody><tr><td>
<div align="CENTER">
<img align="BOTTOM" alt="\includegraphics[scale=0.90909]{figs-python/graph-bfs}" border="0" height="215" src="static/12.3 Graph Traversal_files/img4686.png" width="308"/>
</div></td></tr>
</tbody></table>
</div>
<p>
Analyzing the running-time of the <!-- MATH
 $\ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{i}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{i}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4689.png" width="54"/></span> routine is fairly
straightforward.  The use of the <!-- MATH
 $\ensuremath{\ensuremath{\mathit{seen}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{seen}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4690.png" width="32"/></span> array ensures that no vertex is
added to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4691.png" width="12"/></span> more than once.  Adding (and later removing) each vertex
from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4692.png" width="12"/></span> takes constant time per vertex for a total of <!-- MATH
 $O(\ensuremath{\ensuremath{\ensuremath{\mathit{n}}}})$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ O(\ensuremath{\ensuremath{\ensuremath{\mathit{n}}}})$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4693.png" width="36"/></span> time.
Since each vertex is processed by the inner loop at most once, each
adjacency list is processed at most once, so each edge of <span class="MATH"><img align="MIDDLE" alt="$ G$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4694.png" width="16"/></span> is processed
at most once.  This processing, which is done in the inner loop takes
constant time per iteration, for a total of <!-- MATH
 $O(\ensuremath{\ensuremath{\ensuremath{\mathit{m}}}})$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ O(\ensuremath{\ensuremath{\ensuremath{\mathit{m}}}})$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4695.png" width="40"/></span> time.  Therefore,
the entire algorithm runs in <!-- MATH
 $O(\ensuremath{\ensuremath{\ensuremath{\mathit{n}}}}+\ensuremath{\ensuremath{\ensuremath{\mathit{m}}}})$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ O(\ensuremath{\ensuremath{\ensuremath{\mathit{n}}}}+\ensuremath{\ensuremath{\ensuremath{\mathit{m}}}})$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4696.png" width="65"/></span> time.
</p><p>
The following theorem summarizes the performance of the <!-- MATH
 $\ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4697.png" width="56"/></span> algorithm.
</p><p>
</p><div><a name="thm:bfs-graph"><b>Theorem  <span class="arabic">12</span>..<span class="arabic">3</span></b></a>   
<i>When given as input a Graph, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{g}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{g}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4698.png" width="12"/></span>, that is implemented using the
  AdjacencyLists data structure, the <!-- MATH
 $\ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4699.png" width="56"/></span> algorithm runs in <!-- MATH
 $O(\ensuremath{\ensuremath{\ensuremath{\mathit{n}}}}+\ensuremath{\ensuremath{\ensuremath{\mathit{m}}}})$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ O(\ensuremath{\ensuremath{\ensuremath{\mathit{n}}}}+\ensuremath{\ensuremath{\ensuremath{\mathit{m}}}})$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4700.png" width="65"/></span>
  time.</i></div><p></p>
<p>
A breadth-first traversal has some very special properties.  Calling
<!-- MATH
 $\ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4701.png" width="56"/></span> will eventually enqueue (and eventually dequeue) every vertex
<!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4702.png" width="9"/></span> such that there is a directed path from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{r}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{r}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4703.png" width="10"/></span> to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4704.png" width="9"/></span>.  Moreover,
the vertices at distance 0 from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{r}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{r}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4705.png" width="10"/></span> (<!-- MATH
 $\ensuremath{\ensuremath{\mathit{r}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{r}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4706.png" width="10"/></span> itself) will enter <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4707.png" width="12"/></span> before
the vertices at distance 1, which will enter <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4708.png" width="12"/></span> before the vertices at
distance 2, and so on.  Thus, the <!-- MATH
 $\ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4709.png" width="56"/></span> method visits vertices
in increasing order of distance from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{r}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{r}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4710.png" width="10"/></span> and vertices that cannot be
reached from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{r}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{r}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4711.png" width="10"/></span> are never visited at all.
</p><p>
A particularly useful application of the breadth-first-search algorithm
is, therefore, in computing shortest paths.  To compute the shortest
path from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{r}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{r}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4712.png" width="10"/></span> to every other vertex, we use a variant of <!-- MATH
 $\ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4713.png" width="56"/></span>
that uses an auxilliary array, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{p}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{p}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4714.png" width="12"/></span>, of length <!-- MATH
 $\ensuremath{\ensuremath{\mathit{n}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{n}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4715.png" width="13"/></span>.  When a new vertex
<!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4716.png" width="9"/></span> is added to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{q}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{q}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4717.png" width="12"/></span>, we set <!-- MATH
 $\ensuremath{\ensuremath{\mathit{p}}[\ensuremath{j}]\gets \ensuremath{i}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{p}}[\ensuremath{j}]\gets \ensuremath{i}}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4718.png" width="58"/></span>.  In this way, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{p}}[\ensuremath{\mathit{j}}]}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{p}}[\ensuremath{\mathit{j}}]}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4719.png" width="27"/></span> becomes the
second last node on a shortest path from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{r}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{r}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4720.png" width="10"/></span> to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4721.png" width="9"/></span>.  Repeating this,
by taking <!-- MATH
 $\ensuremath{\ensuremath{\mathit{p}}[\ensuremath{\mathit{p}}[\ensuremath{\mathit{j}}]}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{p}}[\ensuremath{\mathit{p}}[\ensuremath{\mathit{j}}]}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4722.png" width="41"/></span>, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{p}}[\ensuremath{\mathit{p}}[\ensuremath{\mathit{p}}[\ensuremath{\mathit{j}}]}]]$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{p}}[\ensuremath{\mathit{p}}[\ensuremath{\mathit{p}}[\ensuremath{\mathit{j}}]}]]$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4723.png" width="65"/></span>, and so on we can reconstruct the
(reversal of) a shortest path from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{r}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{r}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4724.png" width="10"/></span> to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4725.png" width="9"/></span>.
</p><p>
</p><h2><a name="SECTION001532000000000000000">
<span class="arabic">12</span>.<span class="arabic">3</span>.<span class="arabic">2</span> Depth-First Search</a>
</h2>
<p>
The <span class="textit">depth-first-search</span>
<a name="55656"></a>algorithm is similar to the standard
algorithm for traversing binary trees;  it first fully explores one
subtree before returning to the current node and then exploring the
other subtree.  Another way to think of depth-first-search is by saying
that it is similar to breadth-first search except that it uses a stack
instead of a queue.
</p><p>
During the execution of the depth-first-search algorithm, each vertex,
<!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4726.png" width="9"/></span>, is assigned a colour, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{c}}[\ensuremath{\mathit{i}}]}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{c}}[\ensuremath{\mathit{i}}]}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4727.png" width="26"/></span>: <!-- MATH
 $\ensuremath{\ensuremath{\mathit{white}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{white}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4728.png" width="41"/></span> if we have never seen
the vertex before, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4729.png" width="32"/></span> if we are currently visiting that vertex,
and <!-- MATH
 $\ensuremath{\ensuremath{\mathit{black}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{black}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4730.png" width="38"/></span> if we are done visiting that vertex.  The easiest way to
think of depth-first-search is as a recursive algorithm.  It starts by
visiting <!-- MATH
 $\ensuremath{\ensuremath{\mathit{r}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{r}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4731.png" width="10"/></span>.  When visiting a vertex <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4732.png" width="9"/></span>, we first mark <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4733.png" width="9"/></span> as <!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4734.png" width="32"/></span>.
Next, we scan <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4735.png" width="9"/></span>'s adjacency list and recursively visit any white vertex
we find in this list.  Finally, we are done processing <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4736.png" width="9"/></span>, so we colour
<!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4737.png" width="9"/></span> black and return.
<br/>
<img align="BOTTOM" alt="\begin{leftbar}
\begin{flushleft}
\hspace*{1em} \ensuremath{\mathrm{dfs}(\ensure...
...it{c}}[\ensuremath{i}] \gets \ensuremath{black}}\\
\end{flushleft}\end{leftbar}" border="0" height="239" src="static/12.3 Graph Traversal_files/img4738.png" width="233"/>
<br/>
An example of the execution of this algorithm is shown in Figure <a href="http://opendatastructures.org/ods-python/12_3_Graph_Traversal.html#fig:graph-dfs">12.5</a>.
</p><p>
</p><div align="CENTER"><a name="fig:graph-dfs"></a><a name="57362"></a>
<table>
<caption align="BOTTOM"><strong>Figure 12.5:</strong>
An example of depth-first-search starting at node 0. Nodes are
  labelled with the order in which they are processed.  Edges that
  result in a recursive call are drawn in black, other edges
  are drawn in <!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4740.png" width="32"/></span>.</caption>
<tbody><tr><td>
<div align="CENTER">
<img align="BOTTOM" alt="\includegraphics[scale=0.90909]{figs-python/graph-dfs}" border="0" height="215" src="static/12.3 Graph Traversal_files/img4739.png" width="308"/>
</div></td></tr>
</tbody></table>
</div>
<p>
Although depth-first-search may best be thought of as a recursive
algorithm, recursion is not the best way to implement it. Indeed, the code
given above will fail for many large graphs by causing a stack overflow.
An alternative implementation is to replace the recursion stack with an
explicit stack, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{s}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{s}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4741.png" width="10"/></span>.  The following implementation does just that:
<br/>
<img align="BOTTOM" alt="\begin{leftbar}
\begin{flushleft}
\hspace*{1em} \ensuremath{\mathrm{dfs2}(\ensur...
...thit{s}}.\mathrm{push}(\ensuremath{\mathit{j}})}\\
\end{flushleft}\end{leftbar}" border="0" height="220" src="static/12.3 Graph Traversal_files/img4742.png" width="273"/>
<br/>
In the preceding code, when the next vertex, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4743.png" width="9"/></span>, is processed, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4744.png" width="9"/></span> is coloured
<!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4745.png" width="32"/></span> and then replaced, on the stack, with its adjacent vertices.
During the next iteration, one of these vertices will be visited.
</p><p>
Not surprisingly, the running times of <!-- MATH
 $\ensuremath{\mathrm{dfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{dfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4746.png" width="56"/></span> and <!-- MATH
 $\ensuremath{\mathrm{dfs2}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{dfs2}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4747.png" width="65"/></span> are the
same as that of <!-- MATH
 $\ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{bfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4748.png" width="56"/></span>:
</p><p>
</p><div><a name="thm:dfs-graph"><b>Theorem  <span class="arabic">12</span>..<span class="arabic">4</span></b></a>   
<i>When given as input a Graph, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{g}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{g}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4749.png" width="12"/></span>, that is implemented using the
  AdjacencyLists data structure, the <!-- MATH
 $\ensuremath{\mathrm{dfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{dfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4750.png" width="56"/></span> and <!-- MATH
 $\ensuremath{\mathrm{dfs2}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{dfs2}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4751.png" width="65"/></span> algorithms
  each run in <!-- MATH
 $O(\ensuremath{\ensuremath{\ensuremath{\mathit{n}}}}+\ensuremath{\ensuremath{\ensuremath{\mathit{m}}}})$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ O(\ensuremath{\ensuremath{\ensuremath{\mathit{n}}}}+\ensuremath{\ensuremath{\ensuremath{\mathit{m}}}})$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4752.png" width="65"/></span> time.</i></div><p></p>
<p>
As with the breadth-first-search algorithm, there is an underlying
tree associated with each execution of depth-first-search.  When a node
<!-- MATH
 $\ensuremath{\ensuremath{\ensuremath{\mathit{i}}}}\neq \ensuremath{\ensuremath{\ensuremath{\mathit{r}}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\ensuremath{\mathit{i}}}}\neq \ensuremath{\ensuremath{\ensuremath{\mathit{r}}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4753.png" width="32"/></span> goes from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{white}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{white}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4754.png" width="41"/></span> to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4755.png" width="32"/></span>, this is because <!-- MATH
 $\ensuremath{\mathrm{dfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{i}},\ensuremath{\mathit{c}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{dfs}(\ensuremath{\mathit{g}},\ensuremath{\mathit{i}},\ensuremath{\mathit{c}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4756.png" width="67"/></span>
was called recursively while processing some node <!-- MATH
 $\ensuremath{i}'$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{i}'$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4757.png" width="15"/></span>.  (In the case
of <!-- MATH
 $\ensuremath{\mathrm{dfs2}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\mathrm{dfs2}(\ensuremath{\mathit{g}},\ensuremath{\mathit{r}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4758.png" width="65"/></span> algorithm, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4759.png" width="9"/></span> is one of the nodes that replaced <!-- MATH
 $\ensuremath{i}'$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{i}'$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4760.png" width="15"/></span>
on the stack.)  If we think of <!-- MATH
 $\ensuremath{i}'$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{i}'$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4761.png" width="15"/></span> as the parent of <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4762.png" width="9"/></span>, then we obtain
a tree rooted at <!-- MATH
 $\ensuremath{\ensuremath{\mathit{r}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{r}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4763.png" width="10"/></span>.  In Figure <a href="http://opendatastructures.org/ods-python/12_3_Graph_Traversal.html#fig:graph-dfs">12.5</a>, this tree is a path from
vertex 0 to vertex 11.
</p><p>
An important property of the depth-first-search algorithm is the
following: Suppose that when node <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4764.png" width="9"/></span> is coloured <!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4765.png" width="32"/></span>, there exists a path
from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4766.png" width="9"/></span> to some other node <!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4767.png" width="9"/></span> that uses only white vertices.  Then <!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4768.png" width="9"/></span>
will be coloured first <!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4769.png" width="32"/></span> then <!-- MATH
 $\ensuremath{\ensuremath{\mathit{black}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{black}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4770.png" width="38"/></span> before <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4771.png" width="9"/></span> is coloured <!-- MATH
 $\ensuremath{\ensuremath{\mathit{black}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{black}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4772.png" width="38"/></span>.
(This can be proven by contradiction, by considering any path <span class="MATH"><img align="MIDDLE" alt="$ P$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4773.png" width="15"/></span> from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4774.png" width="9"/></span>
to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4775.png" width="9"/></span>.)
</p><p>
One application of this property is the detection of cycles.
<a name="55878"></a>Refer
to Figure <a href="http://opendatastructures.org/ods-python/12_3_Graph_Traversal.html#fig:dfs-cycle">12.6</a>.  Consider some cycle, <span class="MATH"><img align="MIDDLE" alt="$ C$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4776.png" width="16"/></span>, that can be reached
from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{r}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{r}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4777.png" width="10"/></span>.  Let <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4778.png" width="9"/></span> be the first node of <span class="MATH"><img align="MIDDLE" alt="$ C$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4779.png" width="16"/></span> that is coloured <!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4780.png" width="32"/></span>,
and let <!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4781.png" width="9"/></span> be the node that precedes <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4782.png" width="9"/></span> on the cycle <span class="MATH"><img align="MIDDLE" alt="$ C$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4783.png" width="16"/></span>.  Then,
by the above property, <!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4784.png" width="9"/></span> will be coloured <!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4785.png" width="32"/></span> and the edge <!-- MATH
 $\ensuremath{(\ensuremath{\mathit{j}},\ensuremath{\mathit{i}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{(\ensuremath{\mathit{j}},\ensuremath{\mathit{i}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4786.png" width="30"/></span>
will be considered by the algorithm while <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4787.png" width="9"/></span> is still <!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4788.png" width="32"/></span>.  Thus,
the algorithm can conclude that there is a path, <span class="MATH"><img align="MIDDLE" alt="$ P$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4789.png" width="15"/></span>, from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4790.png" width="9"/></span> to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4791.png" width="9"/></span>
in the depth-first-search tree and the edge <!-- MATH
 $\ensuremath{(\ensuremath{\mathit{j}},\ensuremath{\mathit{i}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{(\ensuremath{\mathit{j}},\ensuremath{\mathit{i}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4792.png" width="30"/></span> exists.  Therefore,
<span class="MATH"><img align="MIDDLE" alt="$ P$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4793.png" width="15"/></span> is also a cycle.
</p><p>
</p><div align="CENTER"><a name="fig:dfs-cycle"></a><a name="57363"></a>
<table>
<caption align="BOTTOM"><strong>Figure 12.6:</strong>
The depth-first-search algorithm can be used to detect cycles
  in <span class="MATH"><img align="MIDDLE" alt="$ G$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4795.png" width="16"/></span>. The node <!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4796.png" width="9"/></span> is coloured <!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4797.png" width="32"/></span> while <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4798.png" width="9"/></span> is still <!-- MATH
 $\ensuremath{\ensuremath{\mathit{grey}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{grey}}}$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4799.png" width="32"/></span>.  This
  implies that there is a path, <span class="MATH"><img align="MIDDLE" alt="$ P$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4800.png" width="15"/></span>, from <!-- MATH
 $\ensuremath{\ensuremath{\mathit{i}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{i}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4801.png" width="9"/></span> to <!-- MATH
 $\ensuremath{\ensuremath{\mathit{j}}}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{\ensuremath{\mathit{j}}}$" border="0" height="30" src="static/12.3 Graph Traversal_files/img4802.png" width="9"/></span> in the depth-first-search
  tree, and the edge <!-- MATH
 $\ensuremath{(\ensuremath{\mathit{j}},\ensuremath{\mathit{i}})}$
 -->
<span class="MATH"><img align="MIDDLE" alt="$ \ensuremath{(\ensuremath{\mathit{j}},\ensuremath{\mathit{i}})}$" border="0" height="31" src="static/12.3 Graph Traversal_files/img4803.png" width="30"/></span> implies that <span class="MATH"><img align="MIDDLE" alt="$ P$" border="0" height="29" src="static/12.3 Graph Traversal_files/img4804.png" width="15"/></span> is also a cycle.</caption>
<tbody><tr><td>
<div align="CENTER">
<img align="BOTTOM" alt="\includegraphics[scale=0.90909]{figs-python/dfs-cycle}" border="0" height="98" src="static/12.3 Graph Traversal_files/img4794.png" width="232"/>
</div></td></tr>
</tbody></table>
</div>
<p>
</p>
<!--End of Navigation Panel-->
<address>
<a href="http://opendatastructures.org/">opendatastructures.org</a>
<script async="" src="static/12.3 Graph Traversal_files/ga.js" type="text/javascript"></script><script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-5860680-3']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript';ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
</address>
</body></html>