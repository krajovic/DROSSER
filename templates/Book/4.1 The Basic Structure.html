<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0063)http://opendatastructures.org/ods-java/4_1_Basic_Structure.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>4.1 The Basic Structure</title>
<meta name="description" content="4.1 The Basic Structure">
<meta name="keywords" content="ods-java-html">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="LaTeX2HTML v2008">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="STYLESHEET" href="static/4.1 The Basic Structure_files/ods-book.css">
<link rel="next" href="http://opendatastructures.org/ods-java/4_2_SkiplistSSet_Efficient_.html">
<link rel="previous" href="http://opendatastructures.org/ods-java/4_Skiplists.html">
<link rel="up" href="http://opendatastructures.org/ods-java/4_Skiplists.html">
<link rel="next" href="http://opendatastructures.org/ods-java/4_2_SkiplistSSet_Efficient_.html">
</head>
<body text="#000000" bgcolor="#FFFFFF">
<h1><a name="SECTION00710000000000000000">
<span class="arabic">4</span>.<span class="arabic">1</span> The Basic Structure</a>
</h1>
<p>
<a name="11776"></a>Conceptually, a skiplist is a sequence of singly-linked lists
<!-- MATH
 $L_0,\ldots,L_h$
 -->
<span class="MATH"><img width="65" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1600.png" alt="$ L_0,\ldots,L_h$"></span>. Each list <span class="MATH"><img width="19" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1601.png" alt="$ L_r$"></span> contains a subset of the items
in <span class="MATH"><img width="33" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1602.png" alt="$ L_{r-1}$"></span>.  We start with the input list <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1603.png" alt="$ L_0$"></span> that contains <!-- MATH
 $\mathtt{n}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1604.png" alt="$ \mathtt{n}$"></span>
items and construct <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1605.png" alt="$ L_1$"></span> from <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1606.png" alt="$ L_0$"></span>, <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1607.png" alt="$ L_2$"></span> from <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1608.png" alt="$ L_1$"></span>, and so on.
The items in <span class="MATH"><img width="19" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1609.png" alt="$ L_r$"></span> are obtained by tossing a coin for each element, <!-- MATH
 $\mathtt{x}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1610.png" alt="$ \mathtt{x}$"></span>,
in <span class="MATH"><img width="33" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1611.png" alt="$ L_{r-1}$"></span> and including <!-- MATH
 $\mathtt{x}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1612.png" alt="$ \mathtt{x}$"></span> in <span class="MATH"><img width="19" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1613.png" alt="$ L_r$"></span> if the coin turns up as heads.
This process ends when we create a list <span class="MATH"><img width="19" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1614.png" alt="$ L_r$"></span> that is empty.  An example
of a skiplist is shown in Figure&nbsp;<a href="http://opendatastructures.org/ods-java/4_1_Basic_Structure.html#fig:skiplist">4.1</a>.
</p><p>
</p><div align="CENTER"><a name="fig:skiplist"></a><a name="11787"></a>
<table>
<caption align="BOTTOM"><strong>Figure 4.1:</strong>
A skiplist containing seven elements.</caption>
<tbody><tr><td>
<div align="CENTER">
<img width="551" height="156" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1615.png" alt="\includegraphics[width=\textwidth ]{figs/skiplist}">
  
</div></td></tr>
</tbody></table>
</div>
<p>
For an element, <!-- MATH
 $\mathtt{x}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1616.png" alt="$ \mathtt{x}$"></span>, in a skiplist, we call the <span class="textit">height</span>
<a name="11792"></a>of <!-- MATH
 $\mathtt{x}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1617.png" alt="$ \mathtt{x}$"></span> the
largest value <span class="MATH"><img width="11" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1618.png" alt="$ r$"></span> such that <!-- MATH
 $\mathtt{x}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1619.png" alt="$ \mathtt{x}$"></span> appears in <span class="MATH"><img width="19" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1620.png" alt="$ L_r$"></span>.  Thus, for example,
elements that only appear in <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1621.png" alt="$ L_0$"></span> have height <span class="MATH">0</span>.  If we spend a few
moments thinking about it, we notice that the height of <!-- MATH
 $\mathtt{x}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1622.png" alt="$ \mathtt{x}$"></span> corresponds
to the following experiment:  Toss a coin repeatedly until it comes
up as tails.  How many times did it come up as heads?  The answer, not
surprisingly, is that the expected height of a node is 1. (We expect to
toss the coin twice before getting tails, but we don't count the last
toss.) The <span class="textit">height</span> of a skiplist is the height of its tallest node.
</p><p>
At the head of every list is a special node, called the <span class="textit">sentinel</span>,
<a name="11798"></a>that acts as a dummy node for the list. The key property of skiplists
is that there is a short path, called the <span class="textit">search path</span>, 
<a name="11800"></a>from the
sentinel in <span class="MATH"><img width="20" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1623.png" alt="$ L_h$"></span> to every node in <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1624.png" alt="$ L_0$"></span>.  Remembering how to construct
a search path for a node, <!-- MATH
 $\mathtt{u}$
 -->
<span class="MATH"><img width="13" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1625.png" alt="$ \mathtt{u}$"></span>, is easy (see Figure&nbsp;<a href="http://opendatastructures.org/ods-java/4_1_Basic_Structure.html#fig:skiplist-searchpath">4.2</a>)
:  Start at the top left corner of your skiplist (the sentinel in <span class="MATH"><img width="20" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1626.png" alt="$ L_h$"></span>)
and always go right unless that would overshoot <!-- MATH
 $\mathtt{u}$
 -->
<span class="MATH"><img width="13" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1627.png" alt="$ \mathtt{u}$"></span>, in which case you
should take a step down into the list below.
</p><p>
More precisely, to construct the search path for the node <!-- MATH
 $\mathtt{u}$
 -->
<span class="MATH"><img width="13" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1628.png" alt="$ \mathtt{u}$"></span> in <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1629.png" alt="$ L_0$"></span>,
we start at the sentinel, <!-- MATH
 $\mathtt{w}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1630.png" alt="$ \mathtt{w}$"></span>, in <span class="MATH"><img width="20" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1631.png" alt="$ L_h$"></span>.  Next, we examine <!-- MATH
 $\mathtt{w.next}$
 -->
<span class="MATH"><img width="50" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1632.png" alt="$ \mathtt{w.next}$"></span>.
If <!-- MATH
 $\mathtt{w.next}$
 -->
<span class="MATH"><img width="50" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1633.png" alt="$ \mathtt{w.next}$"></span> contains an item that appears before <!-- MATH
 $\mathtt{u}$
 -->
<span class="MATH"><img width="13" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1634.png" alt="$ \mathtt{u}$"></span> in <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1635.png" alt="$ L_0$"></span>, then
we set <!-- MATH
 $\ensuremath{\mathtt{w}}=\ensuremath{\mathtt{w.next}}$
 -->
<span class="MATH"><img width="76" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1636.png" alt="$ \ensuremath{\mathtt{w}}=\ensuremath{\mathtt{w.next}}$"></span>.  Otherwise, we move down and continue the search
at the occurrence of <!-- MATH
 $\mathtt{w}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1637.png" alt="$ \mathtt{w}$"></span> in the list <span class="MATH"><img width="34" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1638.png" alt="$ L_{h-1}$"></span>.  We continue this way
until we reach the predecessor of <!-- MATH
 $\mathtt{u}$
 -->
<span class="MATH"><img width="13" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1639.png" alt="$ \mathtt{u}$"></span> in <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1640.png" alt="$ L_0$"></span>. 
</p><div align="CENTER"><a name="fig:skiplist-searchpath"></a><a name="11818"></a>
<table>
<caption align="BOTTOM"><strong>Figure 4.2:</strong>
The search path for the node containing <span class="MATH"><img width="13" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1642.png" alt="$ 4$"></span> in a skiplist.</caption>
<tbody><tr><td>
<div align="CENTER">
<img width="551" height="156" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1641.png" alt="\includegraphics[width=\textwidth ]{figs/skiplist-searchpath}">
  
</div></td></tr>
</tbody></table>
</div>
<p>
The following result, which we will prove in Section&nbsp;<a href="http://opendatastructures.org/ods-java/4_4_Analysis_Skiplists.html#sec:skiplist-analysis">4.4</a>,
shows that the search path is quite short:
</p><p>
</p><p>
</p><div><a name="lem:skiplist-searchpath"><b>Lemma  <span class="arabic">4</span>..<span class="arabic">1</span></b></a> &nbsp; 
<i>The expected length of the search path for any node, <!-- MATH
 $\mathtt{u}$
 -->
<span class="MATH"><img width="13" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1644.png" alt="$ \mathtt{u}$"></span>, in <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1645.png" alt="$ L_0$"></span> is at
most <!-- MATH
 $2\log \ensuremath{\mathtt{n}} + O(1) = O(\log \ensuremath{\mathtt{n}})$
 -->
<span class="MATH"><img width="167" height="31" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1646.png" alt="$ 2\log \ensuremath{\mathtt{n}} + O(1) = O(\log \ensuremath{\mathtt{n}})$"></span>.</i></div><p></p>
<p>
A space-efficient way to implement a skiplist is to define a <tt>Node</tt>,
<!-- MATH
 $\mathtt{u}$
 -->
<span class="MATH"><img width="13" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1647.png" alt="$ \mathtt{u}$"></span>, as consisting of a data value, <!-- MATH
 $\mathtt{x}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1648.png" alt="$ \mathtt{x}$"></span>, and an array, <!-- MATH
 $\mathtt{next}$
 -->
<span class="MATH"><img width="38" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1649.png" alt="$ \mathtt{next}$"></span>, of
pointers, where <!-- MATH
 $\mathtt{u.next[i]}$
 -->
<span class="MATH"><img width="69" height="31" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1650.png" alt="$ \mathtt{u.next[i]}$"></span> points to <!-- MATH
 $\mathtt{u}$
 -->
<span class="MATH"><img width="13" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1651.png" alt="$ \mathtt{u}$"></span>'s successor in the list
<!-- MATH
 $L_{\ensuremath{\mathtt{i}}}$
 -->
<span class="MATH"><img width="20" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1652.png" alt="$ L_{\ensuremath{\mathtt{i}}}$"></span>.  In this way, the data, <!-- MATH
 $\mathtt{x}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1653.png" alt="$ \mathtt{x}$"></span>, in a node is
referenced 
only once, even though <!-- MATH
 $\mathtt{x}$
 -->
<span class="MATH"><img width="13" height="14" align="BOTTOM" border="0" src="static/4.1 The Basic Structure_files/img1654.png" alt="$ \mathtt{x}$"></span> may appear in several lists.
</p><p>
</p><pre>    class Node&lt;T&gt; {
        T x;
        Node&lt;T&gt;[] next;
        Node(T ix, int h) {
            x = ix;
            next = (Node&lt;T&gt;[])Array.newInstance(Node.class, h+1);
        }
        int height() {
            return next.length - 1;
        }
    }
</pre>
<p>
The next two sections of this chapter discuss two different applications
of skiplists.  In each of these applications, <span class="MATH"><img width="21" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1655.png" alt="$ L_0$"></span> stores the main
structure (a list of elements or a sorted set of elements).
The primary difference between these structures is in how
a search path is navigated; in particular, they differ in how
they decide if a search path should go down into <span class="MATH"><img width="33" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1656.png" alt="$ L_{r-1}$"></span> or go right
within <span class="MATH"><img width="19" height="29" align="MIDDLE" border="0" src="static/4.1 The Basic Structure_files/img1657.png" alt="$ L_r$"></span>.
</p><p>
</p><div class="navigation"><hr>
<address>
<a href="http://opendatastructures.org/">opendatastructures.org</a>
    <script type="text/javascript" async="" src="static/4.1 The Basic Structure_files/ga.js"></script><script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-5860680-3']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript';ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
</address>
</body></html>